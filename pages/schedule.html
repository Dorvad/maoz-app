<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="color-scheme" content="light dark" />
  <title>לוח מפגשים | דמו</title>
  <meta name="description" content="לוח מפגשים וחבילות מפגש — דמו." />
  <meta name="theme-color" content="#0B1220" />
    <link rel="stylesheet" href="../styles/app.css">
  <style>
    @media(min-width:720px){ .toolbar{grid-template-columns:1fr 220px} }
  </style>

</head>
<body>
<header class="topbar" role="banner">
  <div class="topbar-inner">
    <a class="brand" href="../index.html" aria-label="חזרה לדשבורד">
      <div class="mark" aria-hidden="true"></div>
      <div class="brand-title">
        <strong>לוח מפגשים</strong>
        <span>דמו • חבילות מפגש, הכנה ותוצרים</span>
      </div>
    </a>
    <div class="chip" title="אתר דמו (לא נתונים אמיתיים)"><span class="dot" aria-hidden="true"></span><span>Demo</span></div>
  </div>
</header>

<main class="wrap" role="main">
  <h1>לוח מפגשים</h1>
  <p>מצאו את המפגש הבא, עברו לחבילת המפגש, והורידו 10 דקות הכנה.</p>

  <section class="card" style="margin-top:12px" aria-label="כלים לסינון">
    <div class="toolbar">
      <label class="search" aria-label="חיפוש">
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M10.5 18.5a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" stroke="currentColor" stroke-width="1.7"/>
          <path d="M16.8 16.8 21 21" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
        </svg>
        <input id="q" type="search" placeholder="חיפוש לפי נושא / תגית / יעד..." autocomplete="off" />
      </label>

      <select id="filter" class="select" aria-label="סינון לפי סטטוס">
        <option value="all">הכל</option>
        <option value="upcoming">בקרוב</option>
        <option value="past">עבר</option>
      </select>
    </div>

    <div class="list" id="list" aria-label="רשימת מפגשים"></div>

    <p class="hint">טיפ: בדמו הזה אפשר כבר לראות “חבילת מפגש” כעמוד נפרד עם מזהה ב־URL.</p>
  </section>
</main>

<nav class="bottom-nav" aria-label="ניווט תחתון">
  <div class="nav-inner">
    <a class="nav-item" href="../index.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M4 10.5 12 4l8 6.5V20a1 1 0 0 1-1 1h-5v-6H10v6H5a1 1 0 0 1-1-1v-9.5Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
      </svg>
      דשבורד
    </a>
    <a class="nav-item" href="./schedule.html" aria-current="page">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M7 3v3M17 3v3M4.5 8.5h15M6 6h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
        <path d="M7.5 12h3M7.5 15.5h6" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
      </svg>
      מפגשים
    </a>
    <a class="nav-item" href="./network.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M16 11a4 4 0 1 0-8 0 4 4 0 0 0 8 0Z" stroke="currentColor" stroke-width="1.7"/>
        <path d="M4.5 20.5a7.5 7.5 0 0 1 15 0" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
      </svg>
      הרשת
    </a>
    <a class="nav-item" href="./library.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M6.5 4h11A2.5 2.5 0 0 1 20 6.5v13A2.5 2.5 0 0 0 17.5 17h-11A2.5 2.5 0 0 1 4 14.5v-8A2.5 2.5 0 0 1 6.5 4Z" stroke="currentColor" stroke-width="1.7"/>
        <path d="M6.5 17h11" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
      </svg>
      ספרייה
    </a>
  </div>
</nav>

<script>
  // Demo data (will move to /data/sessions.json later)
  const SESSIONS = [
    {
      id: "1",
      when: "יום ד׳ · 18:00",
      dateISO: "2026-02-11T18:00:00+02:00",
      where: "ת״א · מרכז כנסים",
      title: "בניית אמון ושפה משותפת סביב דילמות מורכבות",
      summary: "כלים לזהות פערי אמון, לעבור משיח עמדות לשיח אינטרסים, ולבנות הסכמות עבודה.",
      tags: ["אמון", "שיח", "מנהיגות"],
    },
    {
      id: "2",
      when: "יום ה׳ · 09:00",
      dateISO: "2026-02-26T09:00:00+02:00",
      where: "סיור שטח · דרום",
      title: "למידה מבוססת שטח: איך מחברים מדיניות למציאות",
      summary: "סיור מודרך עם משימת למידה: מיפוי בעלי עניין + תיעוד תובנות לשולחן העבודה.",
      tags: ["שטח", "מערכות", "רשויות"],
    },
    {
      id: "0",
      when: "יום ד׳ · 18:00",
      dateISO: "2026-01-28T18:00:00+02:00",
      where: "זום",
      title: "פתיחה: ממלכתיות, אחריות ושיתוף פעולה רב־מגזרי",
      summary: "היכרות עם מסגרת התוכנית והסכם עבודה לקבוצה בטוחה.",
      tags: ["פתיחה", "ממלכתיות", "רשת"],
    },
  ];

  const $ = (s, r=document) => r.querySelector(s);

  function isPast(dateISO){
    const d = new Date(dateISO);
    return d.getTime() < Date.now();
  }

  function renderList(items){
    const list = $("#list");
    list.innerHTML = "";
    if (!items.length){
      list.innerHTML = `
        <div class="session" style="text-align:center">
          <strong>לא נמצאו מפגשים בהתאם לסינון</strong>
          <span>נסו מונח אחר או עברו ל״הכל״.</span>
        </div>`;
      return;
    }

    for (const s of items.sort((a,b)=> new Date(a.dateISO)-new Date(b.dateISO))){
      const past = isPast(s.dateISO);
      const statusBadge = past ? "עבר" : "בקרוב";
      const badgeStyle = past ? "opacity:.85" : "border-color: rgba(155,214,196,.45);";

      const el = document.createElement("article");
      el.className = "session";
      el.innerHTML = `
        <div class="session-head">
          <div class="session-title">
            <strong>${escapeHtml(s.title)}</strong>
            <span>${escapeHtml(s.when)} · ${escapeHtml(s.where)}</span>
          </div>
          <span class="badge" style="${badgeStyle}">${statusBadge}</span>
        </div>

        <span style="color:var(--muted);font-size:13px;line-height:1.55">${escapeHtml(s.summary)}</span>

        <div class="badges">
          ${s.tags.map(t => `<span class="badge">#${escapeHtml(t)}</span>`).join("")}
        </div>

        <div class="row-actions">
          <a class="btn primary" href="./session.html?id=${encodeURIComponent(s.id)}">חבילת מפגש</a>
          <a class="btn" href="./library.html">חומרים רלוונטיים</a>
        </div>
      `;
      list.appendChild(el);
    }
  }

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function apply(){
    const q = ($("#q").value || "").trim().toLowerCase();
    const filter = $("#filter").value;

    let items = SESSIONS.slice();

    if (filter === "upcoming") items = items.filter(s => !isPast(s.dateISO));
    if (filter === "past") items = items.filter(s => isPast(s.dateISO));

    if (q){
      items = items.filter(s => {
        const hay = [s.title, s.summary, s.where, s.when, ...(s.tags||[])].join(" ").toLowerCase();
        return hay.includes(q);
      });
    }

    renderList(items);
  }

  $("#q").addEventListener("input", apply);
  $("#filter").addEventListener("change", apply);

  // initial
  renderList(SESSIONS);
</script>
</body>
</html>
