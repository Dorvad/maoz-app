<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="color-scheme" content="light dark" />
  <title>ספרייה | דמו</title>
  <meta name="description" content="הקלטות, מצגות, תקצירים וכלי יישום — דמו." />
  <meta name="theme-color" content="#0B1220" />
    <link rel="stylesheet" href="../styles/app.css">
  <style>
    @media(min-width:820px){ .toolbar{grid-template-columns:1fr 220px 220px} .collections{grid-template-columns:repeat(3,1fr)} }
  </style>

</head>
<body>
<header class="topbar" role="banner">
  <div class="topbar-inner">
    <a class="brand" href="../index.html" aria-label="חזרה לדשבורד">
      <div class="mark" aria-hidden="true"></div>
      <div class="brand-title">
        <strong>הספרייה</strong>
        <span>דמו • למצוא מהר, להשתמש בשטח</span>
      </div>
    </a>
    <div class="chip"><span class="dot" aria-hidden="true"></span><span>Demo</span></div>
  </div>
</header>

<main class="wrap" role="main">
  <h1>הספרייה</h1>
  <p>הקלטות, תקצירים וכלי עבודה. תייגו, חפשו, ושמרו לפרקטיקה.</p>

  <section class="card" style="margin-top:12px" aria-label="אוספים">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
      <strong style="font-size:15px">אוספים מומלצים</strong>
      <button class="btn" id="clear" type="button">נקה/י סינון</button>
    </div>

    <div class="collections" aria-label="Collections">
      <button class="col" type="button" data-tag="אמון">
        <strong>אמון ושיח</strong>
        <span>כלים לבניית אמון, פרקטיקות שיח, והסכמות עבודה.</span>
      </button>
      <button class="col" type="button" data-tag="שטח">
        <strong>למידה מבוססת שטח</strong>
        <span>סיורים, שאלות חקר, תיעוד ותובנות ליישום.</span>
      </button>
      <button class="col" type="button" data-tag="יישום">
        <strong>יישום לשטח</strong>
        <span>תבניות קצרות: מיפוי בעלי עניין, ניסוי קטן, מדידה.</span>
      </button>
    </div>
  </section>

  <section class="card" style="margin-top:12px" aria-label="חיפוש וסינון">
    <div class="toolbar">
      <label class="search" aria-label="חיפוש תוכן">
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M10.5 18.5a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" stroke="currentColor" stroke-width="1.7"/>
          <path d="M16.8 16.8 21 21" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
        </svg>
        <input id="q" type="search" placeholder="חיפוש לפי נושא / דובר / תגית..." autocomplete="off" />
      </label>

      <select id="type" class="select" aria-label="סינון לפי סוג">
        <option value="all">כל הסוגים</option>
        <option value="recording">הקלטה</option>
        <option value="slides">מצגת</option>
        <option value="template">תבנית</option>
        <option value="summary">תקציר</option>
      </select>

      <a class="btn primary" href="./schedule.html">למפגשים</a>
    </div>

    <div class="list" id="list" aria-label="רשימת פריטים"></div>
  </section>
</main>

<nav class="bottom-nav" aria-label="ניווט תחתון">
  <div class="nav-inner">
    <a class="nav-item" href="../index.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M4 10.5 12 4l8 6.5V20a1 1 0 0 1-1 1h-5v-6H10v6H5a1 1 0 0 1-1-1v-9.5Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
      </svg>
      דשבורד
    </a>
    <a class="nav-item" href="./schedule.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M7 3v3M17 3v3M4.5 8.5h15M6 6h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
        <path d="M7.5 12h3M7.5 15.5h6" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
      </svg>
      מפגשים
    </a>
    <a class="nav-item" href="./network.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M16 11a4 4 0 1 0-8 0 4 4 0 0 0 8 0Z" stroke="currentColor" stroke-width="1.7"/>
        <path d="M4.5 20.5a7.5 7.5 0 0 1 15 0" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
      </svg>
      הרשת
    </a>
    <a class="nav-item" href="./library.html" aria-current="page">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M6.5 4h11A2.5 2.5 0 0 1 20 6.5v13A2.5 2.5 0 0 0 17.5 17h-11A2.5 2.5 0 0 1 4 14.5v-8A2.5 2.5 0 0 1 6.5 4Z" stroke="currentColor" stroke-width="1.7"/>
        <path d="M6.5 17h11" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
      </svg>
      ספרייה
    </a>
  </div>
</nav>

<script>
  const ITEMS = [
    { id:"l1", type:"recording", title:"הקלטה: פתיחה — ממלכתיות ואמון", note:"45 דק׳ · מפגש פתיחה", tags:["אמון","רשת","ממלכתיות"] },
    { id:"l2", type:"slides", title:"מצגת: עמדות → אינטרסים", note:"כלי שיח · מפגש 1", tags:["שיח","אמון","יישום"] },
    { id:"l3", type:"template", title:"תבנית: מיפוי בעלי עניין (10 דק׳)", note:"דף עבודה קצר", tags:["יישום","מערכות","שטח"] },
    { id:"l4", type:"summary", title:"תקציר: למידה מבוססת שטח", note:"2 עמודים", tags:["שטח","יישום"] },
    { id:"l5", type:"template", title:"תבנית: ניסוי קטן לשבוע הקרוב", note:"מוביל שינוי · on-the-job", tags:["יישום","מנהיגות"] },
  ];

  const TYPE_LABEL = { recording:"הקלטה", slides:"מצגת", template:"תבנית", summary:"תקציר" };
  const $ = (s, r=document) => r.querySelector(s);

  let activeTag = null;

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
      .replaceAll('"',"&quot;").replaceAll("'","&#039;");
  }

  function render(list){
    const root = $("#list");
    root.innerHTML = "";

    if (!list.length){
      root.innerHTML = `
        <div class="item" style="text-align:center">
          <strong>לא נמצאו תכנים</strong>
          <span style="color:var(--muted);font-size:13px">נסו חיפוש אחר או נקה/י סינון.</span>
        </div>`;
      return;
    }

    for (const it of list){
      const el = document.createElement("article");
      el.className = "item";
      el.innerHTML = `
        <div class="head">
          <div class="title">
            <strong>${escapeHtml(it.title)}</strong>
            <span>${escapeHtml(it.note)} · ${TYPE_LABEL[it.type] || it.type}</span>
          </div>
          <button class="btn" type="button" data-open="${it.id}">פתח/י</button>
        </div>
        <div class="badges">
          <span class="badge">${TYPE_LABEL[it.type] || it.type}</span>
          ${it.tags.map(t=>`<span class="badge">#${escapeHtml(t)}</span>`).join("")}
        </div>
      `;
      root.appendChild(el);
    }
  }

  function apply(){
    const q = ($("#q").value || "").trim().toLowerCase();
    const type = $("#type").value;

    let list = ITEMS.slice();

    if (type !== "all") list = list.filter(x => x.type === type);
    if (activeTag) list = list.filter(x => (x.tags||[]).includes(activeTag));

    if (q){
      list = list.filter(x => {
        const hay = [x.title, x.note, ...(x.tags||[])].join(" ").toLowerCase();
        return hay.includes(q);
      });
    }

    render(list);
  }

  document.addEventListener("click", (e) => {
    const open = e.target.closest("[data-open]");
    const col = e.target.closest("[data-tag]");
    if (col){
      activeTag = col.getAttribute("data-tag");
      apply();
      return;
    }
    if (open){
      const id = open.getAttribute("data-open");
      alert(`פתיחה (דמו)\nפריט: ${id}\n\nבהמשך נחליף לקישור לקובץ/הקלטה אמיתית + הרשאות.`);
    }
  });

  $("#q").addEventListener("input", apply);
  $("#type").addEventListener("change", apply);
  $("#clear").addEventListener("click", () => { activeTag = null; $("#q").value=""; $("#type").value="all"; apply(); });

  render(ITEMS);
</script>
</body>
</html>
